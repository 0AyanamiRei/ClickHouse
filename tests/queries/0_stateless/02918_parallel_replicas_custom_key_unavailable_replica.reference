-- SET async_socket_for_remote=0;
-- SET async_query_sending_for_remote=0;
-- SET load_balancing='round_robin';
-- SET use_hedged_requests=0;

-- { echoOn }
SELECT y, count()
FROM cluster(parallel_replicas_custom_key_unavailable_replica, currentDatabase(), 02918_parallel_replicas)
GROUP BY y
ORDER BY y
SETTINGS max_parallel_replicas=2, parallel_replicas_custom_key='cityHash64(y)', parallel_replicas_custom_key_filter_type='default';
0	250
1	250
2	250
3	250
SELECT y, count()
FROM cluster(parallel_replicas_custom_key_unavailable_replica, currentDatabase(), 02918_parallel_replicas)
GROUP BY y
ORDER BY y
SETTINGS max_parallel_replicas=3, parallel_replicas_custom_key='cityHash64(y)', parallel_replicas_custom_key_filter_type='range';
0	250
1	250
2	250
3	250
