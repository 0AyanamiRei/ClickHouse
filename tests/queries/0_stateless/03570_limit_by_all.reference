-- Reference output for LIMIT BY ALL comprehensive test suite
-- This file shows the expected output for each test case

-- Test 1: Basic LIMIT BY ALL functionality
-- Should expand to LIMIT 1 BY id, category
-- Expected: One row per (id, category) combination, ordered by id, category
1	A	200	item2
1	A	100	item1
1	B	300	item3
2	A	400	item4
2	A	500	item5
2	B	600	item6
3	C	800	item8
3	C	700	item7
4	A	900	item9
4	B	1000	item10

-- Test 2: LIMIT BY ALL with expressions
-- Should expand to LIMIT 1 BY id, category, value
-- Expected: One row per (id, category, value) combination
1	A	200	item2	400
1	A	100	item1	200
1	B	300	item3	600
2	A	500	item5	1000
2	A	400	item4	800
2	B	600	item6	1200
3	C	700	item7	1400
3	C	800	item8	1600
4	A	900	item9	1800
4	B	1000	item10	2000

-- Test 3: LIMIT BY ALL with aggregate functions
-- Should expand to LIMIT 1 BY id, category (excluding aggregate functions)
-- Expected: One row per (id, category) combination from GROUP BY
1	A	2	300	15.4
1	B	1	300	15.7
2	A	2	900	27.65
2	B	1	600	35.8
3	C	2	1500	42.6
4	A	1	900	50.1
4	B	1	1000	55.3

-- Test 4: LIMIT BY ALL with window functions
-- Should expand to LIMIT 1 BY id, category (excluding window functions)
-- Expected: One row per (id, category) combination
1	A	200	2
1	A	100	1
1	B	300	1
2	A	400	3
2	A	500	4
2	B	600	2
3	C	700	1
3	C	800	2
4	A	900	5
4	B	1000	3

-- Test 5: LIMIT BY ALL with complex expressions
-- Should expand to LIMIT 1 BY id, category, value, name
-- Expected: One row per (id, category, value, name) combination
1	A	100	item1	low	ite
1	A	200	item2	low	ite
1	B	300	item3	low	ite
2	A	400	item4	low	ite
2	A	500	item5	low	ite
2	B	600	item6	high	ite
3	C	700	item7	high	ite
3	C	800	item8	high	ite
4	A	900	item9	high	ite
4	B	1000	item10	high	ite

-- Test 6: LIMIT BY ALL with functions
-- Should expand to LIMIT 1 BY id, category, value, name
-- Expected: One row per (id, category, value, name) combination
1	A	100	item1	ITEM1	110.5
1	A	200	item2	ITEM2	220.3
1	B	300	item3	ITEM3	315.7
2	A	400	item4	ITEM4	425.1
2	A	500	item5	ITEM5	530.2
2	B	600	item6	ITEM6	635.8
3	C	800	item8	ITEM8	845.2
3	C	700	item7	ITEM7	740
4	A	900	item9	ITEM9	950.1
4	B	1000	item10	ITEM10	1055.3

-- Test 7: LIMIT BY ALL with conditional logic
-- Should expand to LIMIT 1 BY id, category, value
-- Expected: One row per (id, category, value) combination
1	A	200	low
1	A	100	low
1	B	300	low
2	A	400	low
2	A	500	low
2	B	600	high
3	C	700	high
3	C	800	high
4	A	900	high
4	B	1000	high

-- Test 8: LIMIT BY ALL with multiple non-aggregate columns
-- Should expand to LIMIT 1 BY id, category, value, name, score, is_active
-- Expected: One row per (id, category, value, name, score, is_active) combination
1	A	200	item2	20.3	false
1	A	100	item1	10.5	true
1	B	300	item3	15.7	true
2	A	500	item5	30.2	false
2	A	400	item4	25.1	true
2	B	600	item6	35.8	true
3	C	700	item7	40	true
3	C	800	item8	45.2	false
4	A	900	item9	50.1	true
4	B	1000	item10	55.3	true

-- Test 9: LIMIT BY ALL with ORDER BY
-- Should expand to LIMIT 1 BY id, category, value
-- Expected: One row per (id, category, value) combination, ordered by value DESC
4	B	1000	item10
4	A	900	item9
3	C	800	item8
3	C	700	item7
2	B	600	item6
2	A	500	item5
2	A	400	item4
1	B	300	item3
1	A	200	item2
1	A	100	item1

-- Test 10: LIMIT BY ALL with WHERE clause
-- Should expand to LIMIT 1 BY id, category, value, name
-- Expected: One row per (id, category, value, name) combination for rows with value > 500
2	B	600	item6
3	C	800	item8
3	C	700	item7
4	A	900	item9
4	B	1000	item10

-- Test 11: LIMIT BY ALL with only aggregate functions
-- Should result in empty LIMIT BY clause (no non-aggregate columns)
-- Expected: Single row with aggregate results (no LIMIT BY expansion)
10	5500	32.82000000000001

-- Test 12: LIMIT BY ALL with HAVING clause
-- Should expand to LIMIT 1 BY id, category
-- Expected: One row per (id, category) combination where count(*) > 1
1	A	2	300
2	A	2	900
3	C	2	1500

-- Test 13: LIMIT BY ALL with subquery
-- Should expand to LIMIT 1 BY id, category, value
-- Expected: One row per (id, category, value) combination
1	A	200	10
1	A	100	10
1	B	300	10
2	A	500	10
2	A	400	10
2	B	600	10
3	C	800	10
3	C	700	10
4	A	900	10
4	B	1000	10

-- Test 14: LIMIT BY ALL with JOIN
-- Should expand to LIMIT 1 BY id, category, value, name
-- Expected: One row per (id, category, value, name) combination from joined tables
1	A	200	item2	100
1	A	100	item1	300
1	A	100	item1	200
1	A	200	item2	200
1	A	200	item2	300
1	A	100	item1	100
1	B	300	item3	200
1	B	300	item3	100
1	B	300	item3	300
2	A	400	item4	500
2	A	400	item4	400
2	A	500	item5	400
2	A	500	item5	500
2	A	400	item4	600
2	A	500	item5	600
2	B	600	item6	600
2	B	600	item6	500
2	B	600	item6	400
3	C	800	item8	700
3	C	700	item7	700
3	C	800	item8	800
3	C	700	item7	800
4	A	900	item9	900
4	A	900	item9	1000
4	B	1000	item10	900
4	B	1000	item10	1000

-- Test 15: LIMIT BY ALL with UNION
-- Should expand to LIMIT 1 BY id, category, value, name
-- Expected: One row per (id, category, value, name) combination from both parts of UNION
1	A	100	item1
1	A	200	item2
1	B	300	item3
2	A	400	item4
2	A	500	item5
2	B	600	item6
3	C	700	item7
3	C	800	item8
4	A	900	item9
4	B	1000	item10

-- Test 16: LIMIT BY ALL with CTE
-- Should expand to LIMIT 1 BY id, category, value, name
-- Expected: One row per (id, category, value, name) combination from CTE (value > 400)
2	A	500	item5
2	B	600	item6
3	C	800	item8
3	C	700	item7
4	A	900	item9
4	B	1000	item10

-- Test 17: LIMIT BY ALL with array functions
-- Should expand to LIMIT 1 BY id, category
-- Expected: One row per (id, category) combination from GROUP BY
1	A	2	['item1','item2']
1	B	1	['item3']
2	A	2	['item4','item5']
2	B	1	['item6']
3	C	2	['item7','item8']
4	A	1	['item9']
4	B	1	['item10']

-- Test 18: LIMIT BY ALL with string functions
-- Should expand to LIMIT 1 BY id, category, value, name
-- Expected: One row per (id, category, value, name) combination
1	A	200	item2	5	A_200
1	A	100	item1	5	A_100
1	B	300	item3	5	B_300
2	A	400	item4	5	A_400
2	A	500	item5	5	A_500
2	B	600	item6	5	B_600
3	C	800	item8	5	C_800
3	C	700	item7	5	C_700
4	A	900	item9	5	A_900
4	B	1000	item10	6	B_1000

-- Test 19: LIMIT BY ALL with mathematical functions
-- Should expand to LIMIT 1 BY id, category, value, score
-- Expected: One row per (id, category, value, score) combination
1	A	100	10.5	10.5	1050
1	A	200	20.3	20.3	4060
1	B	300	15.7	15.7	4710
2	A	500	30.2	30.2	15100
2	A	400	25.1	25.1	10040
2	B	600	35.8	35.8	21480
3	C	800	45.2	45.2	36160
3	C	700	40	40	28000
4	A	900	50.1	50.1	45090
4	B	1000	55.3	55.3	55300

-- Test 20: LIMIT BY ALL with type casting
-- Should expand to LIMIT 1 BY id, category, value, name
-- Expected: One row per (id, category, value, name) combination
1	A	200	item2	200	200
1	A	100	item1	100	100
1	B	300	item3	300	300
2	A	500	item5	500	500
2	A	400	item4	400	400
2	B	600	item6	600	600
3	C	700	item7	700	700
3	C	800	item8	800	800
4	A	900	item9	900	900
4	B	1000	item10	1000	1000 