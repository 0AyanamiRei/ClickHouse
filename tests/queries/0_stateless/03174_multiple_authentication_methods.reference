Basic authentication after user creation
1
Changed password, old password should not work
AUTHENTICATION_FAILED
New password should work
1
Two new passwords were added, should both work
1
1
Authenticating with ssh key
1
Altering credentials and keeping only bcrypt_password
Asserting SSH does not work anymore
AUTHENTICATION_FAILED
Asserting bcrypt_password works
1
Adding new bcrypt_password
Both current authentication methods should work
1
1
Reset authentication methods to new
Only the latest should work, below should fail
AUTHENTICATION_FAILED
Should work
1
Multiple identified with, not allowed
Syntax error
CREATE Multiple identified with, not allowed
Syntax error
Create user with no identification
Add identified with
CREATE USER u01_03174 IDENTIFIED WITH plaintext_password
Try to provide no_password mixed with other authentication methods, should not be allowed
BAD_ARGUMENTS
Adding no_password, should fail
BAD_ARGUMENTS
CREATE USER u01_03174 IDENTIFIED WITH plaintext_password
Replacing existing authentication methods in favor of no_password, should succeed
CREATE USER u01_03174 IDENTIFIED WITH no_password
Trying to auth with no pwd, should succeed
1
Create user with mix both implicit and explicit auth type, starting with with
CREATE USER u01_03174 IDENTIFIED WITH plaintext_password, sha256_password, bcrypt_password, sha256_password
Create user with mix both implicit and explicit auth type, starting with by
CREATE USER u01_03174 IDENTIFIED WITH sha256_password, plaintext_password, bcrypt_password, sha256_password
Use WITH without providing authentication type, should fail
Syntax error
Create user with ADD identification, should fail, add is not allowed for create query
BAD_ARGUMENTS
Trailing comma should result in syntax error
SYNTAX_ERROR
First auth method can't specify type if WITH keyword is not present
SYNTAX_ERROR
