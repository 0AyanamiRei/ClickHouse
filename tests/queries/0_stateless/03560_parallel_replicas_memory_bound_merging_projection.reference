-- { echoOn } --
explain pipeline select b, sum(a) from pr_t group by b order by b limit 5 offset 500 SETTINGS enable_analyzer=1, parallel_replicas_local_plan=1, optimize_use_projections=1, parallel_replicas_support_projection=0;
(Expression)
ExpressionTransform
  (Limit)
  Limit
    (Sorting)
    MergingSortedTransform 10 → 1
      MergeSortingTransform × 10
        LimitsCheckingTransform × 10
          PartialSortingTransform × 10
            (Expression)
            ExpressionTransform × 10
              (MergingAggregated)
              Resize 1 → 10
                SortingAggregatedTransform 10 → 1
                  MergingAggregatedBucketTransform × 10
                    Resize 1 → 10
                      GroupingAggregatedTransform 3 → 1
                        (Union)
                          (Aggregating)
                          Resize 6 → 1
                            AggregatingTransform × 6
                              (Expression)
                              ExpressionTransform × 6
                                (ReadFromMergeTree)
                                MergeTreeSelect(pool: ReadPoolParallelReplicas, algorithm: Thread) × 6 0 → 1
                          (ReadFromRemoteParallelReplicas)
select b, sum(a) from pr_t group by b order by b limit 5 offset 500 SETTINGS enable_analyzer=1, parallel_replicas_local_plan=1, optimize_use_projections=1, parallel_replicas_support_projection=0;
500     500000
501     501000
502     502000
503     503000
504     504000
explain pipeline select b, sum(a) from pr_t group by b order by b limit 5 offset 500 SETTINGS enable_analyzer=1, parallel_replicas_local_plan=1, optimize_use_projections=1, parallel_replicas_support_projection=0, force_aggregation_in_order=1;
(Expression)
ExpressionTransform
  (Limit)
  Limit
    (Sorting)
    MergingSortedTransform 10 → 1
      MergeSortingTransform × 10
        LimitsCheckingTransform × 10
          PartialSortingTransform × 10
            (Expression)
            ExpressionTransform × 10
              (MergingAggregated)
              MergingAggregatedBucketTransform × 10
                Resize 1 → 10
                  FinishAggregatingInOrderTransform 3 → 1
                    (Union)
                      (Aggregating)
                      SortingAggregatedForMemoryBoundMergingTransform 10 → 1
                        MergingAggregatedBucketTransform × 10
                          Resize 1 → 10
                            FinishAggregatingInOrderTransform 6 → 1
                              AggregatingInOrderTransform × 6
                                MergeSortingTransform × 6
                                  LimitsCheckingTransform × 6
                                    PartialSortingTransform × 6
                                      (Expression)
                                      ExpressionTransform × 6
                                        (ReadFromMergeTree)
                                        MergeTreeSelect(pool: ReadPoolParallelReplicas, algorithm: Thread) × 6 0 → 1
                      (ReadFromRemoteParallelReplicas)
select b, sum(a) from pr_t group by b order by b limit 5 offset 500 SETTINGS enable_analyzer=1, parallel_replicas_local_plan=1, optimize_use_projections=1, parallel_replicas_support_projection=0, force_aggregation_in_order=1;
500     500000
501     501000
502     502000
503     503000
504     504000
explain pipeline select b, sum(a) from pr_t group by b order by b limit 5 offset 500 SETTINGS enable_analyzer=1, parallel_replicas_local_plan=1, optimize_use_projections=1, parallel_replicas_support_projection=1;
(Expression)
ExpressionTransform
  (Limit)
  Limit
    (Sorting)
    MergingSortedTransform 10 → 1
      MergeSortingTransform × 10
        LimitsCheckingTransform × 10
          PartialSortingTransform × 10
            (Expression)
            ExpressionTransform × 10
              (MergingAggregated)
              Resize 1 → 10
                SortingAggregatedTransform 10 → 1
                  MergingAggregatedBucketTransform × 10
                    Resize 1 → 10
                      GroupingAggregatedTransform 3 → 1
                        (Union)
                          (Aggregating)
                          FinalizeAggregatedTransform
                            AggregatingInOrderTransform
                              (Expression)
                              ExpressionTransform
                                (ReadFromMergeTree)
                                MergeTreeSelect(pool: ReadPoolParallelReplicasInOrder, algorithm: InOrder) 0 → 1
                          (ReadFromRemoteParallelReplicas)
select b, sum(a) from pr_t group by b order by b limit 5 offset 500 SETTINGS enable_analyzer=1, parallel_replicas_local_plan=1, optimize_use_projections=1, parallel_replicas_support_projection=1;
500     500000
501     501000
502     502000
503     503000
504     504000
