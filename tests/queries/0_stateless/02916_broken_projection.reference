insert new part
insert new part
insert new part
insert new part
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
0
broke metadata of part 'proj' (parent part: all_2_2_0)
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
broken projections info
all_2_2_0	proj	FILE_DOESNT_EXIST
check table full (test - all_2_2_0)
all_2_2_0
0
broke data of part 'proj_2' (parent part: all_2_2_0)
broken projections info
all_2_2_0	proj	FILE_DOESNT_EXIST
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2', expect error: proj_2
FILE_DOESNT_EXIST
check table
0
broken projections info
all_2_2_0	proj	FILE_DOESNT_EXIST
all_2_2_0	proj_2	NO_FILE_IN_DATA_PART
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
0
broke data of part 'proj_2' (parent part: all_3_3_0)
broken projections info
all_2_2_0	proj	FILE_DOESNT_EXIST
all_2_2_0	proj_2	NO_FILE_IN_DATA_PART
insert new part
insert new part
optimize
OPTIMIZE TABLE test SETTINGS alter_sync=0
0
broken projections info
all_2_2_0	proj	FILE_DOESNT_EXIST
all_2_2_0	proj_2	NO_FILE_IN_DATA_PART
all_3_3_0	proj_2	NO_FILE_IN_DATA_PART
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
0
broke metadata of part 'proj' (parent part: all_1_1_0)
Detach - Attach
broken projections info
all_1_1_0	proj	NO_FILE_IN_DATA_PART
all_2_2_0	proj	NO_FILE_IN_DATA_PART
all_2_2_0	proj_2	FILE_DOESNT_EXIST
all_3_3_0	proj_2	FILE_DOESNT_EXIST
0
broke data of part 'proj_2' (parent part: all_1_1_0)
Detach - Attach
broken projections info
all_1_1_0	proj	NO_FILE_IN_DATA_PART
all_1_1_0	proj_2	FILE_DOESNT_EXIST
all_2_2_0	proj	NO_FILE_IN_DATA_PART
all_2_2_0	proj_2	FILE_DOESNT_EXIST
all_3_3_0	proj_2	FILE_DOESNT_EXIST
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
check table full (test - all_1_1_0)
all_1_1_0
materialize projection proj
check table full (test - )
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
materialize projection proj_2
check table full (test - )
0
broke data of part 'proj' (parent part: all_3_5_1_7)
insert new part
optimize
OPTIMIZE TABLE test FINAL
insert new part
optimize
OPTIMIZE TABLE test FINAL
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj_2
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
insert new part
insert new part
insert new part
insert new part
select from projection 'proj'
used projections
SELECT c FROM test2 WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
used projections
SELECT d FROM test2 WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
select from projection 'proj'
used projections
SELECT c FROM test2_replica WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
used projections
SELECT d FROM test2_replica WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
0
broke data of part 'proj' (parent part: all_0_0_0)
check table full (test2 - all_0_0_0)
all_0_0_0
select from projection 'proj'
used projections
SELECT c FROM test2 WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
used projections
SELECT d FROM test2 WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
broke data of part 'all_0_0_0'
check table full (test2 - all_0_0_0)
all_0_0_0
select from projection 'proj'
used projections
SELECT c FROM test2 WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
used projections
SELECT d FROM test2 WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
select from projection 'proj'
used projections
SELECT c FROM test2 WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
used projections
SELECT d FROM test2 WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
insert new part
insert new part
insert new part
insert new part
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
0
broke data of part 'proj' (parent part: all_2_2_0)
select from projection 'proj', expect error: proj
FILE_DOESNT_EXIST
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
broken projections info
all_2_2_0	proj	NO_FILE_IN_DATA_PART
BACKUP_CREATED
RESTORED
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
broken projections info
0
broke all data of part 'proj' (parent part: all_2_2_0)
select from projection 'proj', expect error: proj
Errno
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
broken projections info
all_2_2_0	proj	FILE_DOESNT_EXIST
FILE_DOESNT_EXIST
materialize projection proj
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
broken projections info
all_2_2_0	proj	FILE_DOESNT_EXIST
BACKUP_CREATED
RESTORED
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
1
0
broke all data of part 'proj' (parent part: all_1_1_0)
select from projection 'proj', expect error: proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
broken projections info
all_1_1_0	proj	FILE_DOESNT_EXIST
BACKUP_CREATED
RESTORED
select from projection 'proj'
12
16
used projections
SELECT c FROM test WHERE d == 12 OR d == 16 ORDER BY c;	proj
select from projection 'proj_2'
12
16
used projections
SELECT d FROM test WHERE c == 12 OR c == 16 ORDER BY d;	proj_2
check table
0
broken projections info
all_1_1_0	proj	NO_FILE_IN_DATA_PART
