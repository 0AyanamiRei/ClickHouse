QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: or, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          FUNCTION id: 6, function_name: and, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 7, nodes: 2
                COLUMN id: 8, column_name: A, result_type: UInt8, source_id: 3
                COLUMN id: 9, column_name: B, result_type: UInt8, source_id: 3
          FUNCTION id: 10, function_name: and, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 11, nodes: 2
                COLUMN id: 8, column_name: A, result_type: UInt8, source_id: 3
                COLUMN id: 12, column_name: C, result_type: UInt8, source_id: 3
  SETTINGS optimize_extract_common_expressions=0

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE (__table1.A AND __table1.B) OR (__table1.A AND __table1.C)
SETTINGS optimize_extract_common_expressions = 0
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 8, nodes: 2
                COLUMN id: 9, column_name: B, result_type: UInt8, source_id: 3
                COLUMN id: 10, column_name: C, result_type: UInt8, source_id: 3
  SETTINGS optimize_extract_common_expressions=1

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.A AND (__table1.B OR __table1.C)
SETTINGS optimize_extract_common_expressions = 1
-4890149726841642150	1	1	1	0	0	0
6142641079032712283	1	1	1	0	0	0
-558050477524086008	1	1	1	0	0	0
670122215481070522	1	1	1	0	0	0
-2818642828283588318	1	1	1	0	0	0
-6769625230840672398	1	1	1	0	0	0
2360327909276087486	1	1	1	0	0	0
5422332327868912849	1	1	1	0	0	0
-6185482623805481021	1	1	1	0	0	0
-6276639858940903557	1	1	1	0	0	0
-4890149726841642150	1	1	1	0	0	0
6142641079032712283	1	1	1	0	0	0
-558050477524086008	1	1	1	0	0	0
670122215481070522	1	1	1	0	0	0
-2818642828283588318	1	1	1	0	0	0
-6769625230840672398	1	1	1	0	0	0
2360327909276087486	1	1	1	0	0	0
5422332327868912849	1	1	1	0	0	0
-6185482623805481021	1	1	1	0	0	0
-6276639858940903557	1	1	1	0	0	0
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 3
          COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          COLUMN id: 7, column_name: B, result_type: UInt8, source_id: 3
          COLUMN id: 8, column_name: C, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.A AND __table1.B AND __table1.C
-1417696215412225994	1	1	1	0	0	1
-7491222816216432223	1	1	1	0	0	1
-7667054131998434193	1	1	1	0	0	1
1150290670655138617	1	1	1	0	0	1
-3651160188931679372	1	1	1	0	0	1
7727375535152756381	1	1	1	0	0	1
1248518317831711188	1	1	1	0	0	1
-7224086688461492380	1	1	1	0	0	1
9032006395921235708	1	1	1	0	0	1
7044288989182144315	1	1	1	0	0	1
-1417696215412225994	1	1	1	0	0	1
-7491222816216432223	1	1	1	0	0	1
-7667054131998434193	1	1	1	0	0	1
1150290670655138617	1	1	1	0	0	1
-3651160188931679372	1	1	1	0	0	1
7727375535152756381	1	1	1	0	0	1
1248518317831711188	1	1	1	0	0	1
-7224086688461492380	1	1	1	0	0	1
9032006395921235708	1	1	1	0	0	1
7044288989182144315	1	1	1	0	0	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 4
          COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 8, nodes: 2
                COLUMN id: 9, column_name: E, result_type: UInt8, source_id: 3
                COLUMN id: 10, column_name: F, result_type: UInt8, source_id: 3
          COLUMN id: 11, column_name: B, result_type: UInt8, source_id: 3
          COLUMN id: 12, column_name: C, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.A AND (__table1.E OR __table1.F) AND __table1.B AND __table1.C
-1417696215412225994	1	1	1	0	0	1
-7491222816216432223	1	1	1	0	0	1
-7667054131998434193	1	1	1	0	0	1
1150290670655138617	1	1	1	0	0	1
-3651160188931679372	1	1	1	0	0	1
7727375535152756381	1	1	1	0	0	1
1248518317831711188	1	1	1	0	0	1
-7224086688461492380	1	1	1	0	0	1
9032006395921235708	1	1	1	0	0	1
7044288989182144315	1	1	1	0	0	1
-1417696215412225994	1	1	1	0	0	1
-7491222816216432223	1	1	1	0	0	1
-7667054131998434193	1	1	1	0	0	1
1150290670655138617	1	1	1	0	0	1
-3651160188931679372	1	1	1	0	0	1
7727375535152756381	1	1	1	0	0	1
1248518317831711188	1	1	1	0	0	1
-7224086688461492380	1	1	1	0	0	1
9032006395921235708	1	1	1	0	0	1
7044288989182144315	1	1	1	0	0	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 4
          COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 8, nodes: 2
                COLUMN id: 9, column_name: E, result_type: UInt8, source_id: 3
                COLUMN id: 10, column_name: F, result_type: UInt8, source_id: 3
          COLUMN id: 11, column_name: B, result_type: UInt8, source_id: 3
          COLUMN id: 12, column_name: C, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.A AND (__table1.E OR __table1.F) AND __table1.B AND __table1.C
-7064227703501672459	1	1	0	0	1	0
-5989383837337135212	1	1	0	0	1	0
-2960971598243161531	1	1	0	0	1	0
-2091785646518281290	1	1	0	0	1	0
-2587761388937978501	1	1	0	0	1	0
4189632917510416150	1	1	0	0	1	0
329410740548269838	1	1	0	0	1	0
-966942443397313698	1	1	0	0	1	0
8454473642815416800	1	1	0	0	1	0
8268045340657794461	1	1	0	0	1	0
-7064227703501672459	1	1	0	0	1	0
-5989383837337135212	1	1	0	0	1	0
-2960971598243161531	1	1	0	0	1	0
-2091785646518281290	1	1	0	0	1	0
-2587761388937978501	1	1	0	0	1	0
4189632917510416150	1	1	0	0	1	0
329410740548269838	1	1	0	0	1	0
-966942443397313698	1	1	0	0	1	0
8454473642815416800	1	1	0	0	1	0
8268045340657794461	1	1	0	0	1	0
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 3
          COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 8, nodes: 3
                COLUMN id: 9, column_name: C, result_type: UInt8, source_id: 3
                COLUMN id: 10, column_name: D, result_type: UInt8, source_id: 3
                COLUMN id: 11, column_name: E, result_type: UInt8, source_id: 3
          COLUMN id: 12, column_name: B, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.A AND (__table1.C OR __table1.D OR __table1.E) AND __table1.B
-7064227703501672459	1	1	0	0	1	0
-5989383837337135212	1	1	0	0	1	0
-2960971598243161531	1	1	0	0	1	0
-2091785646518281290	1	1	0	0	1	0
-2587761388937978501	1	1	0	0	1	0
4189632917510416150	1	1	0	0	1	0
329410740548269838	1	1	0	0	1	0
-966942443397313698	1	1	0	0	1	0
8454473642815416800	1	1	0	0	1	0
8268045340657794461	1	1	0	0	1	0
-7064227703501672459	1	1	0	0	1	0
-5989383837337135212	1	1	0	0	1	0
-2960971598243161531	1	1	0	0	1	0
-2091785646518281290	1	1	0	0	1	0
-2587761388937978501	1	1	0	0	1	0
4189632917510416150	1	1	0	0	1	0
329410740548269838	1	1	0	0	1	0
-966942443397313698	1	1	0	0	1	0
8454473642815416800	1	1	0	0	1	0
8268045340657794461	1	1	0	0	1	0
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 3
          COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 8, nodes: 3
                COLUMN id: 9, column_name: C, result_type: UInt8, source_id: 3
                COLUMN id: 10, column_name: D, result_type: UInt8, source_id: 3
                COLUMN id: 11, column_name: E, result_type: UInt8, source_id: 3
          COLUMN id: 12, column_name: B, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.A AND (__table1.C OR __table1.D OR __table1.E) AND __table1.B
7046366705027993992	0	1	1	0	0	0
5876398964123690873	0	1	1	0	0	0
-4849840134697008981	0	1	1	0	0	0
8219785106025342771	0	1	1	0	0	0
7106055360641449065	0	1	1	0	0	0
7782502397032484090	0	1	1	0	0	0
1587022221789919998	0	1	1	0	0	0
-5488510425784433218	0	1	1	0	0	0
-3751993301879274716	0	1	1	0	0	0
3995320070609749801	0	1	1	0	0	0
7046366705027993992	0	1	1	0	0	0
5876398964123690873	0	1	1	0	0	0
-4849840134697008981	0	1	1	0	0	0
8219785106025342771	0	1	1	0	0	0
7106055360641449065	0	1	1	0	0	0
7782502397032484090	0	1	1	0	0	0
1587022221789919998	0	1	1	0	0	0
-5488510425784433218	0	1	1	0	0	0
-3751993301879274716	0	1	1	0	0	0
3995320070609749801	0	1	1	0	0	0
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          COLUMN id: 6, column_name: B, result_type: UInt8, source_id: 3
          COLUMN id: 7, column_name: C, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.B AND __table1.C
331058316081182921	0	1	1	0	0	1
-2878539180531591201	0	1	1	0	0	1
5634271855584736521	0	1	1	0	0	1
602708131544673121	0	1	1	0	0	1
-7538506014351088906	0	1	1	0	0	1
-7767907992783882398	0	1	1	0	0	1
3427035445395945973	0	1	1	0	0	1
1130846464892565445	0	1	1	0	0	1
-7229259894257180861	0	1	1	0	0	1
-9156504923995237243	0	1	1	0	0	1
331058316081182921	0	1	1	0	0	1
-2878539180531591201	0	1	1	0	0	1
5634271855584736521	0	1	1	0	0	1
602708131544673121	0	1	1	0	0	1
-7538506014351088906	0	1	1	0	0	1
-7767907992783882398	0	1	1	0	0	1
3427035445395945973	0	1	1	0	0	1
1130846464892565445	0	1	1	0	0	1
-7229259894257180861	0	1	1	0	0	1
-9156504923995237243	0	1	1	0	0	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 3
          COLUMN id: 6, column_name: B, result_type: UInt8, source_id: 3
          COLUMN id: 7, column_name: C, result_type: UInt8, source_id: 3
          FUNCTION id: 8, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 9, nodes: 2
                COLUMN id: 10, column_name: E, result_type: UInt8, source_id: 3
                COLUMN id: 11, column_name: F, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.B AND __table1.C AND (__table1.E OR __table1.F)
331058316081182921	0	1	1	0	0	1
-2878539180531591201	0	1	1	0	0	1
5634271855584736521	0	1	1	0	0	1
602708131544673121	0	1	1	0	0	1
-7538506014351088906	0	1	1	0	0	1
-7767907992783882398	0	1	1	0	0	1
3427035445395945973	0	1	1	0	0	1
1130846464892565445	0	1	1	0	0	1
-7229259894257180861	0	1	1	0	0	1
-9156504923995237243	0	1	1	0	0	1
331058316081182921	0	1	1	0	0	1
-2878539180531591201	0	1	1	0	0	1
5634271855584736521	0	1	1	0	0	1
602708131544673121	0	1	1	0	0	1
-7538506014351088906	0	1	1	0	0	1
-7767907992783882398	0	1	1	0	0	1
3427035445395945973	0	1	1	0	0	1
1130846464892565445	0	1	1	0	0	1
-7229259894257180861	0	1	1	0	0	1
-9156504923995237243	0	1	1	0	0	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 3
          COLUMN id: 6, column_name: B, result_type: UInt8, source_id: 3
          COLUMN id: 7, column_name: C, result_type: UInt8, source_id: 3
          FUNCTION id: 8, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 9, nodes: 2
                COLUMN id: 10, column_name: E, result_type: UInt8, source_id: 3
                COLUMN id: 11, column_name: F, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.B AND __table1.C AND (__table1.E OR __table1.F)
-8350064335402276481	0	1	0	0	1	0
2766908592531260293	0	1	0	0	1	0
-8500464668406226757	0	1	0	0	1	0
-4469615932557529717	0	1	0	0	1	0
-2676464305117434926	0	1	0	0	1	0
-3455317119139662830	0	1	0	0	1	0
5588544998641306169	0	1	0	0	1	0
-9173414302980908256	0	1	0	0	1	0
7212851845568196641	0	1	0	0	1	0
-3704547074519116929	0	1	0	0	1	0
-8350064335402276481	0	1	0	0	1	0
2766908592531260293	0	1	0	0	1	0
-8500464668406226757	0	1	0	0	1	0
-4469615932557529717	0	1	0	0	1	0
-2676464305117434926	0	1	0	0	1	0
-3455317119139662830	0	1	0	0	1	0
5588544998641306169	0	1	0	0	1	0
-9173414302980908256	0	1	0	0	1	0
7212851845568196641	0	1	0	0	1	0
-3704547074519116929	0	1	0	0	1	0
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          COLUMN id: 6, column_name: B, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 8, nodes: 3
                COLUMN id: 9, column_name: C, result_type: UInt8, source_id: 3
                COLUMN id: 10, column_name: D, result_type: UInt8, source_id: 3
                COLUMN id: 11, column_name: E, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.B AND (__table1.C OR __table1.D OR __table1.E)
-8350064335402276481	0	1	0	0	1	0
2766908592531260293	0	1	0	0	1	0
-8500464668406226757	0	1	0	0	1	0
-4469615932557529717	0	1	0	0	1	0
-2676464305117434926	0	1	0	0	1	0
-3455317119139662830	0	1	0	0	1	0
5588544998641306169	0	1	0	0	1	0
-9173414302980908256	0	1	0	0	1	0
7212851845568196641	0	1	0	0	1	0
-3704547074519116929	0	1	0	0	1	0
-8350064335402276481	0	1	0	0	1	0
2766908592531260293	0	1	0	0	1	0
-8500464668406226757	0	1	0	0	1	0
-4469615932557529717	0	1	0	0	1	0
-2676464305117434926	0	1	0	0	1	0
-3455317119139662830	0	1	0	0	1	0
5588544998641306169	0	1	0	0	1	0
-9173414302980908256	0	1	0	0	1	0
7212851845568196641	0	1	0	0	1	0
-3704547074519116929	0	1	0	0	1	0
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          COLUMN id: 6, column_name: B, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 8, nodes: 3
                COLUMN id: 9, column_name: C, result_type: UInt8, source_id: 3
                COLUMN id: 10, column_name: D, result_type: UInt8, source_id: 3
                COLUMN id: 11, column_name: E, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.B AND (__table1.C OR __table1.D OR __table1.E)
7296788055532769937	0	1	0	0	0	0
-8085083078325036349	0	1	0	0	0	0
8056746393406743698	0	1	0	0	0	0
-5618901525230504315	0	1	0	0	0	0
-6790762979674887120	0	1	0	0	0	0
7609629462704427873	0	1	0	0	0	0
7776384315538625189	0	1	0	0	0	0
1381341868259371991	0	1	0	0	0	0
2483552736214921240	0	1	0	0	0	0
5286533408672438546	0	1	0	0	0	0
7296788055532769937	0	1	0	0	0	0
-8085083078325036349	0	1	0	0	0	0
8056746393406743698	0	1	0	0	0	0
-5618901525230504315	0	1	0	0	0	0
-6790762979674887120	0	1	0	0	0	0
7609629462704427873	0	1	0	0	0	0
7776384315538625189	0	1	0	0	0	0
1381341868259371991	0	1	0	0	0	0
2483552736214921240	0	1	0	0	0	0
5286533408672438546	0	1	0	0	0	0
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          FUNCTION id: 6, function_name: equals, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 7, nodes: 2
                FUNCTION id: 8, function_name: sipHash64, function_type: ordinary, result_type: UInt64
                  ARGUMENTS
                    LIST id: 9, nodes: 1
                      COLUMN id: 10, column_name: C, result_type: UInt8, source_id: 3
                FUNCTION id: 11, function_name: sipHash64, function_type: ordinary, result_type: UInt64
                  ARGUMENTS
                    LIST id: 12, nodes: 1
                      COLUMN id: 13, column_name: D, result_type: UInt8, source_id: 3
          FUNCTION id: 14, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 15, nodes: 2
                COLUMN id: 16, column_name: A, result_type: UInt8, source_id: 3
                COLUMN id: 17, column_name: B, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE (sipHash64(__table1.C) = sipHash64(__table1.D)) AND (__table1.A OR __table1.B)
2589067852420946093	0	0	0	0	1	1
566510304360553038	0	0	0	0	1	1
4712156778925374545	0	0	0	0	1	1
6513794688600930866	0	0	0	0	1	1
8420009359281429633	0	0	0	0	1	1
2151442296722776334	0	0	0	0	1	1
-7155015417725275505	0	0	0	0	1	1
8063264694611659226	0	0	0	0	1	1
7596093258110041712	0	0	0	0	1	1
-5463634588980750408	0	0	0	0	1	1
2589067852420946093	0	0	0	0	1	1
566510304360553038	0	0	0	0	1	1
4712156778925374545	0	0	0	0	1	1
6513794688600930866	0	0	0	0	1	1
8420009359281429633	0	0	0	0	1	1
2151442296722776334	0	0	0	0	1	1
-7155015417725275505	0	0	0	0	1	1
8063264694611659226	0	0	0	0	1	1
7596093258110041712	0	0	0	0	1	1
-5463634588980750408	0	0	0	0	1	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: or, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          FUNCTION id: 6, function_name: and, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 7, nodes: 2
                COLUMN id: 8, column_name: A, result_type: UInt8, source_id: 3
                COLUMN id: 9, column_name: B, result_type: UInt8, source_id: 3
          FUNCTION id: 10, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 11, nodes: 2
                FUNCTION id: 12, function_name: and, function_type: ordinary, result_type: UInt8
                  ARGUMENTS
                    LIST id: 13, nodes: 2
                      COLUMN id: 14, column_name: C, result_type: UInt8, source_id: 3
                      COLUMN id: 15, column_name: D, result_type: UInt8, source_id: 3
                FUNCTION id: 16, function_name: and, function_type: ordinary, result_type: UInt8
                  ARGUMENTS
                    LIST id: 17, nodes: 2
                      COLUMN id: 18, column_name: E, result_type: UInt8, source_id: 3
                      COLUMN id: 19, column_name: F, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE (__table1.A AND __table1.B) OR ((__table1.C AND __table1.D) OR (__table1.E AND __table1.F))
813655996633899418	0	0	0	0	1	1
6513794688600930866	0	0	0	0	1	1
2151442296722776334	0	0	0	0	1	1
-2316167413850459561	0	0	0	0	1	1
-5864912137959118127	0	0	0	0	1	1
-5326152364639478952	0	0	0	0	1	1
-5463634588980750408	0	0	0	0	1	1
6704351461338887300	0	0	0	0	1	1
-973750167321101279	0	0	0	0	1	1
8063264694611659226	0	0	0	0	1	1
813655996633899418	0	0	0	0	1	1
6513794688600930866	0	0	0	0	1	1
2151442296722776334	0	0	0	0	1	1
-2316167413850459561	0	0	0	0	1	1
-5864912137959118127	0	0	0	0	1	1
-5326152364639478952	0	0	0	0	1	1
-5463634588980750408	0	0	0	0	1	1
6704351461338887300	0	0	0	0	1	1
-973750167321101279	0	0	0	0	1	1
8063264694611659226	0	0	0	0	1	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: or, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          FUNCTION id: 6, function_name: and, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 7, nodes: 2
                COLUMN id: 8, column_name: A, result_type: UInt8, source_id: 3
                COLUMN id: 9, column_name: B, result_type: UInt8, source_id: 3
          FUNCTION id: 10, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 11, nodes: 2
                FUNCTION id: 12, function_name: and, function_type: ordinary, result_type: UInt8
                  ARGUMENTS
                    LIST id: 13, nodes: 2
                      COLUMN id: 9, column_name: B, result_type: UInt8, source_id: 3
                      COLUMN id: 14, column_name: D, result_type: UInt8, source_id: 3
                FUNCTION id: 15, function_name: and, function_type: ordinary, result_type: UInt8
                  ARGUMENTS
                    LIST id: 16, nodes: 2
                      COLUMN id: 17, column_name: E, result_type: UInt8, source_id: 3
                      COLUMN id: 18, column_name: F, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE (__table1.A AND __table1.B) OR ((__table1.B AND __table1.D) OR (__table1.E AND __table1.F))
6015136002503835948	1	1	0	0	0	1
-3883799183493487473	1	1	0	0	0	1
-3002427897361111856	1	1	0	0	0	1
-2523952504416578832	1	1	0	0	0	1
-3187045566703922613	1	1	0	0	0	1
4838814183373278674	1	1	0	0	0	1
620980830413267931	1	1	0	0	0	1
-5907701125400227703	1	1	0	0	0	1
-1174991811984636509	1	1	0	0	0	1
446104724568266173	1	1	0	0	0	1
6015136002503835948	1	1	0	0	0	1
-3883799183493487473	1	1	0	0	0	1
-3002427897361111856	1	1	0	0	0	1
-2523952504416578832	1	1	0	0	0	1
-3187045566703922613	1	1	0	0	0	1
4838814183373278674	1	1	0	0	0	1
620980830413267931	1	1	0	0	0	1
-5907701125400227703	1	1	0	0	0	1
-1174991811984636509	1	1	0	0	0	1
446104724568266173	1	1	0	0	0	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 3
          COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          COLUMN id: 7, column_name: B, result_type: UInt8, source_id: 3
          FUNCTION id: 8, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 9, nodes: 3
                COLUMN id: 10, column_name: C, result_type: UInt8, source_id: 3
                FUNCTION id: 11, function_name: and, function_type: ordinary, result_type: UInt8
                  ARGUMENTS
                    LIST id: 12, nodes: 2
                      COLUMN id: 13, column_name: E, result_type: UInt8, source_id: 3
                      COLUMN id: 13, column_name: E, result_type: UInt8, source_id: 3
                FUNCTION id: 14, function_name: and, function_type: ordinary, result_type: UInt8
                  ARGUMENTS
                    LIST id: 15, nodes: 2
                      COLUMN id: 16, column_name: F, result_type: UInt8, source_id: 3
                      COLUMN id: 16, column_name: F, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.A AND __table1.B AND (__table1.C OR (__table1.E AND __table1.E) OR (__table1.F AND __table1.F))
-7079903752397632178	1	1	0	1	0	1
7410531019670261947	1	1	0	1	0	1
233866682657554364	1	1	0	1	0	1
704993795727957061	1	1	0	1	0	1
4554773761331986827	1	1	0	1	0	1
5016240913683434733	1	1	0	1	0	1
21469839474705446	1	1	0	1	0	1
2093705149861909566	1	1	0	1	0	1
2363609859499966990	1	1	0	1	0	1
5595451911922654649	1	1	0	1	0	1
-7079903752397632178	1	1	0	1	0	1
7410531019670261947	1	1	0	1	0	1
233866682657554364	1	1	0	1	0	1
704993795727957061	1	1	0	1	0	1
4554773761331986827	1	1	0	1	0	1
5016240913683434733	1	1	0	1	0	1
21469839474705446	1	1	0	1	0	1
2093705149861909566	1	1	0	1	0	1
2363609859499966990	1	1	0	1	0	1
5595451911922654649	1	1	0	1	0	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 4
          FUNCTION id: 6, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 7, nodes: 2
                COLUMN id: 8, column_name: C, result_type: UInt8, source_id: 3
                COLUMN id: 9, column_name: D, result_type: UInt8, source_id: 3
          COLUMN id: 10, column_name: A, result_type: UInt8, source_id: 3
          COLUMN id: 11, column_name: B, result_type: UInt8, source_id: 3
          FUNCTION id: 12, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 13, nodes: 2
                COLUMN id: 14, column_name: E, result_type: UInt8, source_id: 3
                COLUMN id: 15, column_name: F, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE (__table1.C OR __table1.D) AND __table1.A AND __table1.B AND (__table1.E OR __table1.F)
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: _CAST, function_type: ordinary, result_type: Nullable(UInt8)
      ARGUMENTS
        LIST id: 5, nodes: 2
          FUNCTION id: 6, function_name: and, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 7, nodes: 2
                COLUMN id: 8, column_name: B, result_type: UInt8, source_id: 3
                COLUMN id: 9, column_name: C, result_type: UInt8, source_id: 3
          CONSTANT id: 10, constant_value: \'Nullable(UInt8)\', constant_value_type: String

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE _CAST(__table1.B AND __table1.C, \'Nullable(UInt8)\')
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: _CAST, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          COLUMN id: 6, column_name: x, result_type: Int64, source_id: 3
          CONSTANT id: 7, constant_value: \'UInt8\', constant_value_type: String

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE _CAST(__table1.x, \'UInt8\')
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: and, function_type: ordinary, result_type: Nullable(UInt8)
      ARGUMENTS
        LIST id: 5, nodes: 2
          COLUMN id: 6, column_name: B, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: toNullable, function_type: ordinary, result_type: Nullable(UInt8)
            ARGUMENTS
              LIST id: 8, nodes: 1
                COLUMN id: 9, column_name: C, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.B AND toNullable(__table1.C)
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 4, function_name: or, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 5, nodes: 2
          COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          FUNCTION id: 7, function_name: and, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 8, nodes: 2
                COLUMN id: 9, column_name: B, result_type: UInt8, source_id: 3
                FUNCTION id: 10, function_name: or, function_type: ordinary, result_type: UInt8
                  ARGUMENTS
                    LIST id: 11, nodes: 2
                      FUNCTION id: 12, function_name: and, function_type: ordinary, result_type: UInt8
                        ARGUMENTS
                          LIST id: 13, nodes: 2
                            COLUMN id: 14, column_name: C, result_type: UInt8, source_id: 3
                            COLUMN id: 15, column_name: D, result_type: UInt8, source_id: 3
                      FUNCTION id: 16, function_name: and, function_type: ordinary, result_type: UInt8
                        ARGUMENTS
                          LIST id: 17, nodes: 2
                            COLUMN id: 14, column_name: C, result_type: UInt8, source_id: 3
                            COLUMN id: 18, column_name: E, result_type: UInt8, source_id: 3

SELECT count() AS `count()`
FROM default.x AS __table1
WHERE __table1.A OR (__table1.B AND ((__table1.C AND __table1.D) OR (__table1.C AND __table1.E)))
-9220342792229035180	1	1	0	1	0	1	-9218747728814747926	1	1	0	0	0	1
-9220342792229035180	1	1	0	1	0	1	-9217081065560798881	1	0	0	1	0	1
-9220342792229035180	1	1	0	1	0	1	-9211856624818647543	1	1	1	0	0	0
-9220342792229035180	1	1	0	1	0	1	-9190487214870855200	1	1	1	1	1	1
-9220342792229035180	1	1	0	1	0	1	-9160211915115471089	1	0	0	0	1	1
-9220342792229035180	1	1	0	1	0	1	-9105451307219421605	1	0	1	1	1	1
-9220342792229035180	1	1	0	1	0	1	-9077371913032868764	1	1	0	0	1	1
-9220342792229035180	1	1	0	1	0	1	-9077295854519266595	1	1	0	0	1	0
-9220342792229035180	1	1	0	1	0	1	-9041842932373383548	1	1	0	0	0	1
-9220342792229035180	1	1	0	1	0	1	-9037094316313599791	1	0	0	1	0	1
-9220342792229035180	1	1	0	1	0	1	-9218747728814747926	1	1	0	0	0	1
-9220342792229035180	1	1	0	1	0	1	-9217081065560798881	1	0	0	1	0	1
-9220342792229035180	1	1	0	1	0	1	-9211856624818647543	1	1	1	0	0	0
-9220342792229035180	1	1	0	1	0	1	-9190487214870855200	1	1	1	1	1	1
-9220342792229035180	1	1	0	1	0	1	-9160211915115471089	1	0	0	0	1	1
-9220342792229035180	1	1	0	1	0	1	-9105451307219421605	1	0	1	1	1	1
-9220342792229035180	1	1	0	1	0	1	-9077371913032868764	1	1	0	0	1	1
-9220342792229035180	1	1	0	1	0	1	-9077295854519266595	1	1	0	0	1	0
-9220342792229035180	1	1	0	1	0	1	-9041842932373383548	1	1	0	0	0	1
-9220342792229035180	1	1	0	1	0	1	-9037094316313599791	1	0	0	1	0	1
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    JOIN id: 3, strictness: ALL, kind: INNER
      LEFT TABLE EXPRESSION
        TABLE id: 4, alias: __table1, table_name: default.x
      RIGHT TABLE EXPRESSION
        TABLE id: 5, alias: __table2, table_name: default.y
      JOIN EXPRESSION
        FUNCTION id: 6, function_name: and, function_type: ordinary, result_type: UInt8
          ARGUMENTS
            LIST id: 7, nodes: 2
              FUNCTION id: 8, function_name: equals, function_type: ordinary, result_type: UInt8
                ARGUMENTS
                  LIST id: 9, nodes: 2
                    COLUMN id: 10, column_name: A, result_type: UInt8, source_id: 4
                    COLUMN id: 11, column_name: A, result_type: UInt8, source_id: 5
              FUNCTION id: 12, function_name: or, function_type: ordinary, result_type: UInt8
                ARGUMENTS
                  LIST id: 13, nodes: 2
                    FUNCTION id: 14, function_name: equals, function_type: ordinary, result_type: UInt8
                      ARGUMENTS
                        LIST id: 15, nodes: 2
                          COLUMN id: 16, column_name: B, result_type: UInt8, source_id: 4
                          CONSTANT id: 17, constant_value: UInt64_1, constant_value_type: UInt8
                    FUNCTION id: 18, function_name: equals, function_type: ordinary, result_type: UInt8
                      ARGUMENTS
                        LIST id: 19, nodes: 2
                          COLUMN id: 20, column_name: C, result_type: UInt8, source_id: 5
                          CONSTANT id: 21, constant_value: UInt64_1, constant_value_type: UInt8

SELECT count() AS `count()`
FROM default.x AS __table1
ALL INNER JOIN default.y AS __table2 ON (__table1.A = __table2.A) AND ((__table1.B = 1) OR (__table2.C = 1))
QUERY id: 0
  PROJECTION COLUMNS
    count() UInt64
  PROJECTION
    LIST id: 1, nodes: 1
      FUNCTION id: 2, function_name: count, function_type: aggregate, result_type: UInt64
  JOIN TREE
    JOIN id: 3, strictness: ALL, kind: INNER
      LEFT TABLE EXPRESSION
        TABLE id: 4, alias: __table1, table_name: default.x
      RIGHT TABLE EXPRESSION
        TABLE id: 5, alias: __table2, table_name: default.y
      JOIN EXPRESSION
        FUNCTION id: 6, function_name: or, function_type: ordinary, result_type: UInt8
          ARGUMENTS
            LIST id: 7, nodes: 2
              FUNCTION id: 8, function_name: equals, function_type: ordinary, result_type: UInt8
                ARGUMENTS
                  LIST id: 9, nodes: 2
                    COLUMN id: 10, column_name: A, result_type: UInt8, source_id: 4
                    COLUMN id: 11, column_name: A, result_type: UInt8, source_id: 5
              FUNCTION id: 12, function_name: and, function_type: ordinary, result_type: UInt8
                ARGUMENTS
                  LIST id: 13, nodes: 2
                    FUNCTION id: 14, function_name: equals, function_type: ordinary, result_type: UInt8
                      ARGUMENTS
                        LIST id: 15, nodes: 2
                          COLUMN id: 16, column_name: B, result_type: UInt8, source_id: 4
                          COLUMN id: 17, column_name: B, result_type: UInt8, source_id: 5
                    FUNCTION id: 18, function_name: or, function_type: ordinary, result_type: UInt8
                      ARGUMENTS
                        LIST id: 19, nodes: 2
                          FUNCTION id: 20, function_name: and, function_type: ordinary, result_type: UInt8
                            ARGUMENTS
                              LIST id: 21, nodes: 2
                                FUNCTION id: 22, function_name: equals, function_type: ordinary, result_type: UInt8
                                  ARGUMENTS
                                    LIST id: 23, nodes: 2
                                      COLUMN id: 24, column_name: C, result_type: UInt8, source_id: 4
                                      COLUMN id: 25, column_name: C, result_type: UInt8, source_id: 5
                                FUNCTION id: 26, function_name: equals, function_type: ordinary, result_type: UInt8
                                  ARGUMENTS
                                    LIST id: 27, nodes: 2
                                      COLUMN id: 28, column_name: D, result_type: UInt8, source_id: 4
                                      COLUMN id: 29, column_name: D, result_type: UInt8, source_id: 5
                          FUNCTION id: 30, function_name: and, function_type: ordinary, result_type: UInt8
                            ARGUMENTS
                              LIST id: 31, nodes: 2
                                FUNCTION id: 32, function_name: equals, function_type: ordinary, result_type: UInt8
                                  ARGUMENTS
                                    LIST id: 33, nodes: 2
                                      COLUMN id: 34, column_name: C, result_type: UInt8, source_id: 4
                                      COLUMN id: 35, column_name: C, result_type: UInt8, source_id: 5
                                FUNCTION id: 36, function_name: equals, function_type: ordinary, result_type: UInt8
                                  ARGUMENTS
                                    LIST id: 37, nodes: 2
                                      COLUMN id: 38, column_name: E, result_type: UInt8, source_id: 4
                                      COLUMN id: 39, column_name: E, result_type: UInt8, source_id: 5

SELECT count() AS `count()`
FROM default.x AS __table1
ALL INNER JOIN default.y AS __table2 ON (__table1.A = __table2.A) OR ((__table1.B = __table2.B) AND (((__table1.C = __table2.C) AND (__table1.D = __table2.D)) OR ((__table1.C = __table2.C) AND (__table1.E = __table2.E))))
-9220342792229035180	1	1	0	1	0	1
-9215479184005563028	0	1	1	1	0	1
-9211524111550600160	0	0	1	1	1	0
-9220342792229035180	1	1	0	1	0	1
-9215479184005563028	0	1	1	1	0	1
-9211524111550600160	0	0	1	1	1	0
QUERY id: 0
  PROJECTION COLUMNS
    x Int64
    A UInt8
    B UInt8
    C UInt8
    D UInt8
    E UInt8
    F UInt8
  PROJECTION
    LIST id: 1, nodes: 7
      COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
      COLUMN id: 4, column_name: A, result_type: UInt8, source_id: 3
      COLUMN id: 5, column_name: B, result_type: UInt8, source_id: 3
      COLUMN id: 6, column_name: C, result_type: UInt8, source_id: 3
      COLUMN id: 7, column_name: D, result_type: UInt8, source_id: 3
      COLUMN id: 8, column_name: E, result_type: UInt8, source_id: 3
      COLUMN id: 9, column_name: F, result_type: UInt8, source_id: 3
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  WHERE
    FUNCTION id: 10, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 11, nodes: 2
          COLUMN id: 12, column_name: C, result_type: UInt8, source_id: 3
          COLUMN id: 13, column_name: E, result_type: UInt8, source_id: 3

SELECT
    __table1.x AS x,
    __table1.A AS A,
    __table1.B AS B,
    __table1.C AS C,
    __table1.D AS D,
    __table1.E AS E,
    __table1.F AS F
FROM default.x AS __table1
WHERE __table1.C AND __table1.E
-9220342792229035180	1	1	0
-9185424447834220126	1	0	1
-9147221708390825551	1	1	1
-9114850274891890829	1	1	1
-9114000995382454016	1	0	1
-9099767307959300756	1	1	0
-9077645148896772804	1	1	1
-9076550218784816665	1	1	0
-9074857609628938868	1	1	0
-9066338222341664310	1	1	1
-9220342792229035180	1	1	0
-9185424447834220126	1	0	1
-9147221708390825551	1	1	1
-9114850274891890829	1	1	1
-9114000995382454016	1	0	1
-9099767307959300756	1	1	0
-9077645148896772804	1	1	1
-9076550218784816665	1	1	0
-9074857609628938868	1	1	0
-9066338222341664310	1	1	1
QUERY id: 0
  PROJECTION COLUMNS
    x Int64
    mA UInt8
    mB UInt8
    mC UInt8
  PROJECTION
    LIST id: 1, nodes: 4
      COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
      FUNCTION id: 4, function_name: max, function_type: aggregate, result_type: UInt8
        ARGUMENTS
          LIST id: 5, nodes: 1
            COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
      FUNCTION id: 7, function_name: max, function_type: aggregate, result_type: UInt8
        ARGUMENTS
          LIST id: 8, nodes: 1
            COLUMN id: 9, column_name: B, result_type: UInt8, source_id: 3
      FUNCTION id: 10, function_name: max, function_type: aggregate, result_type: UInt8
        ARGUMENTS
          LIST id: 11, nodes: 1
            COLUMN id: 12, column_name: C, result_type: UInt8, source_id: 3
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  GROUP BY
    LIST id: 13, nodes: 1
      COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
  HAVING
    FUNCTION id: 14, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 15, nodes: 2
          FUNCTION id: 4, function_name: max, function_type: aggregate, result_type: UInt8
            ARGUMENTS
              LIST id: 5, nodes: 1
                COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
          FUNCTION id: 16, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 17, nodes: 2
                FUNCTION id: 7, function_name: max, function_type: aggregate, result_type: UInt8
                  ARGUMENTS
                    LIST id: 8, nodes: 1
                      COLUMN id: 9, column_name: B, result_type: UInt8, source_id: 3
                FUNCTION id: 10, function_name: max, function_type: aggregate, result_type: UInt8
                  ARGUMENTS
                    LIST id: 11, nodes: 1
                      COLUMN id: 12, column_name: C, result_type: UInt8, source_id: 3

SELECT
    __table1.x AS x,
    max(__table1.A) AS mA,
    max(__table1.B) AS mB,
    max(__table1.C) AS mC
FROM default.x AS __table1
GROUP BY __table1.x
HAVING max(__table1.A) AND (max(__table1.B) OR max(__table1.C))
-9220342792229035180	1	1	0
-9215479184005563028	1	1	1
-9185424447834220126	1	1	1
-9173414302980908256	1	1	1
-9152339068839888086	1	1	1
-9147221708390825551	1	1	1
-9120736630719629705	1	0	1
-9114850274891890829	1	1	1
-9114000995382454016	1	1	1
-9099767307959300756	1	1	0
-9220342792229035180	1	1	0
-9215479184005563028	1	1	1
-9185424447834220126	1	1	1
-9173414302980908256	1	1	1
-9152339068839888086	1	1	1
-9147221708390825551	1	1	1
-9120736630719629705	1	0	1
-9114850274891890829	1	1	1
-9114000995382454016	1	1	1
-9099767307959300756	1	1	0
QUERY id: 0
  PROJECTION COLUMNS
    x Int64
    mA UInt8
    mB UInt8
    mC UInt8
  PROJECTION
    LIST id: 1, nodes: 4
      COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
      FUNCTION id: 4, function_name: max, function_type: window, result_type: UInt8
        ARGUMENTS
          LIST id: 5, nodes: 1
            COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
        WINDOW
          WINDOW id: 7, frame_type: RANGE, frame_begin_type: unbounded preceding, frame_end_type: current
            PARTITION BY
              LIST id: 8, nodes: 1
                FUNCTION id: 9, function_name: modulo, function_type: ordinary, result_type: Int32
                  ARGUMENTS
                    LIST id: 10, nodes: 2
                      COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
                      CONSTANT id: 11, constant_value: UInt64_1000, constant_value_type: UInt16
      FUNCTION id: 12, function_name: max, function_type: window, result_type: UInt8
        ARGUMENTS
          LIST id: 13, nodes: 1
            COLUMN id: 14, column_name: B, result_type: UInt8, source_id: 3
        WINDOW
          WINDOW id: 15, frame_type: RANGE, frame_begin_type: unbounded preceding, frame_end_type: current
            PARTITION BY
              LIST id: 16, nodes: 1
                FUNCTION id: 17, function_name: modulo, function_type: ordinary, result_type: Int32
                  ARGUMENTS
                    LIST id: 18, nodes: 2
                      COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
                      CONSTANT id: 19, constant_value: UInt64_1000, constant_value_type: UInt16
      FUNCTION id: 20, function_name: max, function_type: window, result_type: UInt8
        ARGUMENTS
          LIST id: 21, nodes: 1
            COLUMN id: 22, column_name: C, result_type: UInt8, source_id: 3
        WINDOW
          WINDOW id: 23, frame_type: RANGE, frame_begin_type: unbounded preceding, frame_end_type: current
            PARTITION BY
              LIST id: 24, nodes: 1
                FUNCTION id: 25, function_name: modulo, function_type: ordinary, result_type: Int32
                  ARGUMENTS
                    LIST id: 26, nodes: 2
                      COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
                      CONSTANT id: 27, constant_value: UInt64_1000, constant_value_type: UInt16
  JOIN TREE
    TABLE id: 3, alias: __table1, table_name: default.x
  QUALIFY
    FUNCTION id: 28, function_name: and, function_type: ordinary, result_type: UInt8
      ARGUMENTS
        LIST id: 29, nodes: 2
          FUNCTION id: 4, function_name: max, function_type: window, result_type: UInt8
            ARGUMENTS
              LIST id: 5, nodes: 1
                COLUMN id: 6, column_name: A, result_type: UInt8, source_id: 3
            WINDOW
              WINDOW id: 7, frame_type: RANGE, frame_begin_type: unbounded preceding, frame_end_type: current
                PARTITION BY
                  LIST id: 8, nodes: 1
                    FUNCTION id: 9, function_name: modulo, function_type: ordinary, result_type: Int32
                      ARGUMENTS
                        LIST id: 10, nodes: 2
                          COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
                          CONSTANT id: 11, constant_value: UInt64_1000, constant_value_type: UInt16
          FUNCTION id: 30, function_name: or, function_type: ordinary, result_type: UInt8
            ARGUMENTS
              LIST id: 31, nodes: 2
                FUNCTION id: 12, function_name: max, function_type: window, result_type: UInt8
                  ARGUMENTS
                    LIST id: 13, nodes: 1
                      COLUMN id: 14, column_name: B, result_type: UInt8, source_id: 3
                  WINDOW
                    WINDOW id: 15, frame_type: RANGE, frame_begin_type: unbounded preceding, frame_end_type: current
                      PARTITION BY
                        LIST id: 16, nodes: 1
                          FUNCTION id: 17, function_name: modulo, function_type: ordinary, result_type: Int32
                            ARGUMENTS
                              LIST id: 18, nodes: 2
                                COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
                                CONSTANT id: 19, constant_value: UInt64_1000, constant_value_type: UInt16
                FUNCTION id: 20, function_name: max, function_type: window, result_type: UInt8
                  ARGUMENTS
                    LIST id: 21, nodes: 1
                      COLUMN id: 22, column_name: C, result_type: UInt8, source_id: 3
                  WINDOW
                    WINDOW id: 23, frame_type: RANGE, frame_begin_type: unbounded preceding, frame_end_type: current
                      PARTITION BY
                        LIST id: 24, nodes: 1
                          FUNCTION id: 25, function_name: modulo, function_type: ordinary, result_type: Int32
                            ARGUMENTS
                              LIST id: 26, nodes: 2
                                COLUMN id: 2, column_name: x, result_type: Int64, source_id: 3
                                CONSTANT id: 27, constant_value: UInt64_1000, constant_value_type: UInt16

SELECT
    __table1.x AS x,
    max(__table1.A) OVER (PARTITION BY __table1.x % 1000) AS mA,
    max(__table1.B) OVER (PARTITION BY __table1.x % 1000) AS mB,
    max(__table1.C) OVER (PARTITION BY __table1.x % 1000) AS mC
FROM default.x AS __table1
QUALIFY max(__table1.A) OVER (PARTITION BY (__table1.x % 1000)) AND (max(__table1.B) OVER (PARTITION BY (__table1.x % 1000)) OR max(__table1.C) OVER (PARTITION BY (__table1.x % 1000)))
