<test>

  <query>
    SELECT number
    FROM numbers_mt(1e8) AS n inner join
    (
        SELECT 157::UInt64 AS p
        FROM system.one
    ) AS o
    on number = p
    FORMAT Null SETTINGS max_threads=1, join_algorithm='hash'
  </query>

  <query>
    SELECT number
    FROM numbers_mt(1e9) AS n inner join
    (
        SELECT 157::UInt64 AS p
        FROM system.one
    ) AS o
    on number = p
    FORMAT Null SETTINGS max_threads=8, join_algorithm='hash'
  </query>

  <query>select count() from numbers_mt(1e7) as lhs inner join numbers_mt(1e6) as rhs on lhs.number = rhs.number or lhs.number = rhs.number+1 format Null</query>
  <query>select count() from numbers_mt(5e8) as lhs inner join numbers_mt(1e1) as rhs on lhs.number = rhs.number or lhs.number = rhs.number+1 format Null</query>
  <query>select count() from numbers_mt(5e8) as lhs inner join numbers_mt(1e1) as rhs on lhs.number = rhs.number or lhs.number % 2 = 1 format Null</query>
</test>
