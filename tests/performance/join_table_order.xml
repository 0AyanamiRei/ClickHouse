<test>
    <create_query>CREATE TABLE small_table (id Int64, value Int64, data String) ENGINE = Memory</create_query>
    <create_query>CREATE TABLE medium_table (id Int64, value Int64, data String) ENGINE = Memory</create_query>
    <create_query>CREATE TABLE large_table (id Int64, value Int64, data String) ENGINE = Memory</create_query>

    <!-- Fill small table (100 rows) -->
    <fill_query>INSERT INTO small_table SELECT number AS id, number * 10 AS value, concat('small_', toString(number)) AS data FROM numbers(100)</fill_query>

    <!-- Fill medium table (10,000 rows) -->
    <fill_query>INSERT INTO medium_table SELECT number AS id, number * 5 AS value, concat('medium_', toString(number)) AS data FROM numbers(10000)</fill_query>

    <!-- Fill large table (1,000,000 rows) -->
    <fill_query>INSERT INTO large_table SELECT number AS id, number * 2 AS value, concat('large_', toString(number)) AS data FROM numbers(1000000)</fill_query>

    <query tag='3WAY_SMALL_FIRST'>
        SELECT ignore(*) FROM small_table s
        INNER JOIN medium_table m ON s.id = m.id % 100
        INNER JOIN large_table l ON m.id = l.id % 10000
        WHERE s.value = 500
        SETTINGS query_plan_optimize_join_order_limit = 64
    </query>

    <query tag='3WAY_LARGE_FIRST'>
        SELECT ignore(*) FROM large_table l
        INNER JOIN medium_table m ON l.id % 10000 = m.id
        INNER JOIN small_table s ON m.id % 100 = s.id
        WHERE s.value = 500
        SETTINGS query_plan_optimize_join_order_limit = 64
    </query>

    <query tag='4WAY'>
        SELECT ignore(*) FROM small_table s1
        INNER JOIN small_table s2 ON s1.id = s2.id
        INNER JOIN medium_table m ON s2.id = m.id % 100
        INNER JOIN large_table l ON m.id = l.id % 10000
        WHERE s1.value &lt; 100
        SETTINGS query_plan_optimize_join_order_limit = 64
    </query>

    <drop_query>DROP TABLE IF EXISTS small_table</drop_query>
    <drop_query>DROP TABLE IF EXISTS medium_table</drop_query>
    <drop_query>DROP TABLE IF EXISTS large_table</drop_query>
</test>
